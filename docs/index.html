<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>: State-of-the-art Gradle Android Builds</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js/css/theme/gradle.css" id="theme" /><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet" /><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "reveal.js/css/print/pdf.css" : "reveal.js/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="reveal.js/lib/js/html5shiv.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-player.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-theme-gradle.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/github-gist.css" />
<script src="reveal.js/css/theme/asciinema-player.js"></script></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title" data-transition="zoom" data-transition-speed="fast" data-background-image="./images/title.jpeg"><h1></h1><h2>State-of-the-art Gradle Android Builds</h2><div class="preamble"><div class="paragraph"><p><h2>
Gradle Night Berlin
</h2></p></div>
<div class="paragraph"><p>Volker Leck (@devisnik) - Gradle Inc.</p></div></div></section>
<section><section id="gradle-org-com"><h2>Gradle.{org,com}</h2></section><section id="gradle-org"><h2>Gradle.org</h2><div class="paragraph"><p>Gradle is a build and automation tool.</p></div>
<div class="ulist"><ul><li class="fragment"><p>agnostic Build System</p></li><li class="fragment"><p>100% Free Open Source - Apache Standard License 2.0</p></li></ul></div></section><section id="gradle-inc"><h2>Gradle Inc.</h2><div class="paragraph"><p>The company behind Gradle.</p></div>
<div class="ulist"><ul><li class="fragment"><p>Build Happiness</p></li><li class="fragment"><p>Employs full time engineers</p></li><li class="fragment"><p>Providing Gradle Build Scans and Gradle Enterprise</p></li><li class="fragment"><p>Consulting and Training</p></li></ul></div>
<div class="ulist"><ul><li class="fragment"><p><a href="https://gradle.com/training/" class="bare">https://gradle.com/training/</a></p></li><li class="fragment"><p><a href="https://gradle.com/blog/tag/webcast/" class="bare">https://gradle.com/blog/tag/webcast/</a></p></li></ul></div></section></section>
<section><section id="what-is-a-modern-build"><h2>What is a modern build?</h2></section><section><div class="ulist"><ul><li><p>reliable / reproducible</p></li><li><p>customizable</p></li><li><p>universal</p></li><li><p>self-contained</p></li><li><p>fast, smart</p></li><li><p>maintainable</p></li></ul></div></section><section id="build-engineering"><h2>Build engineering</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>In a healthy culture, developers and engineering leaders understand that the domain of building and integrating software is just as complex and challenging as the domain of application development.</p></div></blockquote><div class="attribution">&#8212; Hans Dockter, Founder and CEO of Gradle Inc.</div></div>
<div class="paragraph"><p><a href="https://gradle.com/blog/build-engineer-challenges/" class="bare">https://gradle.com/blog/build-engineer-challenges/</a></p></div></section></section>
<section><section id="gradle-in-a-nutshell"><h2>Gradle in a nutshell</h2></section><section id="core-engine"><h2>Core Engine</h2><div class="imageblock" style=""><img src="./images/gradle-task-dag.png" alt="gradle task dag" width="1280" height="350px" /></div></section><section id="core-engine-2"><h2>Core Engine</h2><div class="ulist"><ul><li><p>Groovy and Kotlin build scripts</p></li><li><p>Task configuration and execution</p></li><li><p>Dependency resolution</p></li><li><p>Work avoidance</p></li></ul></div></section><section><pre class="highlight listingblock"><code data-noescape="" class="bash language-bash">├── [ 962]  build.gradle
├── [  96]  gradle
│       ├── [ 54K]  gradle-wrapper.jar
│       └── [ 202]  gradle-wrapper.properties
├── [5.8K]  gradlew
├── [2.9K]  gradlew.bat
├── [ 359]  settings.gradle</code></pre></section><section id="plugins" data-transition="none"><h2>Plugins</h2><div class="ulist"><ul><li><p>adapt core engine to a domain</p></li><li><p>make build declarative</p></li></ul></div></section><section><div class="ulist"><ul><li><p>Core Plugins</p><div class="ulist"><ul><li><p><code>java-library</code>, <code>application</code>, <code>groovy</code>, <code>maven-publish</code> &#8230;&#8203;</p></li></ul></div></li><li><p>Community Plugins</p><div class="ulist"><ul><li><p><code>kotlin</code>, <code>android</code>, <code>golang</code>, <code>pygradle</code>, <code>asciidoctor</code> &#8230;&#8203;</p></li></ul></div></li></ul></div></section><section><div class="ulist"><ul><li><p>Plugins contribute</p><div class="ulist"><ul><li class="fragment"><p>reusable and configurable tasks</p></li><li class="fragment"><p>configurable extensions</p></li></ul></div></li></ul></div></section><section data-transition="none"><div class="ulist"><ul><li><p>Plugins contribute <strong>a model to configure</strong></p><div class="ulist"><ul><li class="fragment"><p>in build scripts</p></li><li class="fragment"><p>using a DSL</p></li></ul></div></li></ul></div></section><section id="a-java-library-groovy-dsl"><h2>A Java library (Groovy DSL)</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">plugins {
   id "java-library"
}

dependencies {
   api "com.acme:foo:1.0"
   implementation "com.zoo:monkey:1.1"
}

tasks.withType(JavaCompile) {
    // ...
}</code></pre></section><section id="a-native-app-kotlin-dsl"><h2>A native app (Kotlin DSL)</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">plugins {
    `cpp-application`
}

application {
    baseName = "my-app"
}

toolChains {
    // ...
}</code></pre></section><section id="an-android-app"><h2>An Android App</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">apply plugin: 'com.android.application'

dependencies {
    implementation "androidx.appcompat:appcompat:1.0.2"
    // ...
}

android {
    compileSdkVersion 28
    buildToolsVersion "28.0.3"
    // ...
    defaultConfig {
        minSdkVersion 19
        targetSdkVersion 28
    }
    // ...
}</code></pre></section><section id="demo"><h2>DEMO</h2><div class="paragraph"><p><a href="https://github.com/k9mail/k-9" class="bare">https://github.com/k9mail/k-9</a></p></div></section></section>
<section><section id="perf-matters"><h2>Perf matters</h2></section><section id="what-is-slow"><h2>What is slow?</h2><div class="ulist"><ul><li><p>structured approach</p><div class="ulist"><ul><li><p>define scenario</p></li><li><p>profile</p></li><li><p>identify bottlenecks</p></li><li><p>fix</p></li><li><p>verify fix</p></li><li><p>repeat</p></li></ul></div></li></ul></div></section><section id="toolbelt"><h2>Toolbelt</h2><div class="ulist"><ul><li><p><code>--profile</code></p></li><li><p><code>--scan</code></p></li><li><p>Gradle profiler</p></li></ul></div></section><section id="build-scans"><h2>Build Scans</h2><div class="imageblock" style=""><img src="./images/build-scan-overview.png" alt="Build Scan Overview" width="1100" height="500" /></div>
<div class="paragraph"><p><a href="http://scans.gradle.com" class="bare">http://scans.gradle.com</a></p></div></section><section id="gradle-profiler"><h2>Gradle Profiler</h2><div class="ulist"><ul><li><p>runs pre-defined scenarios</p></li><li><p>can produce Build scans</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="">check-no-tests {
    tasks = ["check"]
    gradle-args = ["-x", "test"]
    cleanup-tasks = ["clean"]
    run-using = tooling-api // value can also be "cli" or "no-daemon"
    warm-ups = 2
}</code></pre>
<div class="paragraph"><p><a href="https://github.com/gradle/gradle-profiler" class="bare">https://github.com/gradle/gradle-profiler</a></p></div></section><section id="general-advice"><h2>General Advice</h2></section><section id="stay-up-to-date"><h2>Stay up-to-date</h2><div class="paragraph"><p><code>./gradlew wrapper --gradle-version 5.3.1</code></p></div>
<div class="title">build.gradle</div><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">classpath 'com.android.tools.build:gradle:3.3.2'</code></pre></section><section id="jvm-tuning"><h2>JVM Tuning</h2><div class="paragraph"><p><code>org.gradle.jvmargs=-Xmx4G</code></p></div>
<div class="ulist"><ul><li><p>provide enough heap space</p></li><li><p>tweaks often do more harm than good</p></li><li><p>rather work on structural improvements</p></li></ul></div></section><section id="daemon"><h2>Daemon</h2><div class="paragraph"><p><code>org.gradle.daemon = true</code></p></div>
<div class="ulist"><ul><li><p>enabled by default</p></li><li><p>in-memory caches</p></li><li><p>when building repeatedly</p></li><li><p>Do not disable it!</p></li></ul></div></section><section id="parallelism"><h2>Parallelism</h2><div class="paragraph"><p><code>org.gradle.parallel = true</code></p></div>
<div class="ulist"><ul><li><p>not enabled by default</p></li><li><p>usually safe to enable</p></li><li><p>speeds up multi-project builds</p></li></ul></div></section><section id="build-cache"><h2>Build Cache</h2><div class="paragraph"><p><code>org.gradle.caching = true</code></p></div>
<pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">// root build.gradle
// only for kotlin &lt; 1.3.30
subprojects {
	pluginManager.withPlugin("kotlin-kapt") {
		kapt.useBuildCache = true
	}
}</code></pre></section><section id="where-is-the-problem"><h2>Where is the problem?</h2></section><section id="build-lifecycle"><h2>Build Lifecycle</h2><div class="imageblock" style=""><img src="./images/scan-performance.png" alt="the build lifecycle" width="1100" height="500" /></div></section><section id="red-flags"><h2>Red flags</h2><div class="ulist"><ul><li><p>startup / settings / buildSrc &gt; 1s</p></li><li><p>no-op build doing any work</p></li><li><p>single line change ~= clean build</p></li><li><p>high gc time</p><div class="paragraph"><p>K-9 with <code>-Xmx=1G</code>: <a href="https://gradle.com/s/n7q54jqbq3qma" class="bare">https://gradle.com/s/n7q54jqbq3qma</a></p></div></li></ul></div></section><section id="red-flags-example"><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">// settings.gradle
// do not do this
new File('.').eachFile(FileType.DIRECTORIES) { dir -&gt;
    include dir.name
}</code></pre></section><section id="startup-settings-buildsrc"><h2>Startup / Settings / BuildSrc</h2><div class="imageblock" style=""><img src="./images/scans-daemon-status.png" alt="keep daemon healty" width="1100" height="350" /></div>
<div class="paragraph"><p><a href="https://scans.gradle.com/s/n7q54jqbq3qma/performance/daemon" class="bare">https://scans.gradle.com/s/n7q54jqbq3qma/performance/daemon</a></p></div>
<div class="paragraph"><p><code>./gradlew --status</code></p></div>
<div class="paragraph"><p><code>pgrep -lf "GradleDaemon"</code></p></div></section><section id="configuration"><h2>Configuration</h2><div class="ulist"><ul><li><p>Applying plugins</p></li><li><p>Evaluating build scripts</p></li><li><p>Running afterEvaluate {} blocks</p></li></ul></div></section><section id="configuration-time"><h2>Configuration time</h2><div class="ulist"><ul><li><p>Before running any task</p></li><li><p>Even gradlew help / gradlew tasks</p></li><li><p>Android Studio sync</p></li></ul></div>
<div class="paragraph"><p>Avoid Dependency resolution at configuration time!</p></div>
<div class="paragraph"><p>Be aware of inefficient plugins!</p></div></section><section id="execution"><h2>Execution</h2><div class="ulist"><ul><li><p>Executing selected tasks</p></li><li><p>Incremental</p></li><li><p>Cacheable</p></li><li><p>Parallelizable</p></li></ul></div></section><section id="incremental-builds"><h2>Incremental Builds</h2><div class="paragraph"><p>Nothing changed?
Executed tasks should be zero!</p></div>
<div class="paragraph"><p>Watch out for volatile inputs!</p></div></section><section id="faster-compilation"><h2>Faster Compilation</h2><div class="ulist"><ul><li><p>Modularization &#8658; Compile avoidance</p></li><li><p>Decoupled code &#8658; Faster incremental compilation</p></li><li><p>Careful with Kotlin annotation processing (for now)</p></li></ul></div></section><section id="resources"><h2>Resources</h2><div class="ulist"><ul><li><p><a href="https://gradle.com/blog/improving-android-and-java-build-performance/" class="bare">https://gradle.com/blog/improving-android-and-java-build-performance/</a></p></li><li><p>Tony Robalik: droidcon SF 2018 - Improving Android Build performance
<a href="https://www.youtube.com/watch?v=XZFnuFUMT7w" class="bare">https://www.youtube.com/watch?v=XZFnuFUMT7w</a></p></li></ul></div></section></section>
<section><section id="configuration-2"><h2>Configuration</h2></section><section id="what"><h2>What</h2><div class="ulist"><ul><li><p>applying plugins</p></li><li><p>evaluating build scripts</p></li><li><p>running <code>afterEvaluate{}</code> blocks</p></li></ul></div></section><section id="when"><h2>When</h2><div class="ulist"><ul><li><p>on any Gradle run</p></li><li><p>Android Studio sync</p></li></ul></div></section><section id="resolution-at-configuration-time"><h2>Resolution at configuration time</h2><div class="paragraph"><p><a href="https://scans.gradle.com/s/drql6mfq73cdi/performance/configuration#summary-task-created-immediately" class="bare">https://scans.gradle.com/s/drql6mfq73cdi/performance/configuration#summary-task-created-immediately</a></p></div></section><section id="eager-resolution"><h2>Eager Resolution</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">task fatJar(type: Jar) {
    from configurations.compile.collect {
	it.isDirectory() ? it : zipTree(it)
    }
    with jar
    classifier = 'uber-jar'
}</code></pre>
<div class="paragraph"><p><a href="https://scans.gradle.com/s/drql6mfq73cdi/performance/configuration" class="bare">https://scans.gradle.com/s/drql6mfq73cdi/performance/configuration</a></p></div></section><section id="lazy-resolution"><h2>Lazy Resolution</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">task fatJar(type: Jar) {
    from {
	configurations.compile.collect {
	    it.isDirectory() ? it : zipTree(it)
	}
    }
    with jar
    classifier = 'uber-jar'
}</code></pre></section><section id="configuration-avoidance"><h2>Configuration Avoidance</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">tasks.register("fatJar", Jar) {
    from configurations.compile.collect {
        it.isDirectory() ? it : zipTree(it)
    }
    with jar
    classifier = 'uber-jar'
}</code></pre>
<div class="paragraph"><p><a href="https://scans.gradle.com/s/ulzhbqz7wls5a/performance/configuration" class="bare">https://scans.gradle.com/s/ulzhbqz7wls5a/performance/configuration</a></p></div>
<div class="paragraph"><p><a href="https://docs.gradle.org/current/userguide/task_configuration_avoidance.html" class="bare">https://docs.gradle.org/current/userguide/task_configuration_avoidance.html</a>
<a href="https://blog.gradle.org/preview-avoiding-task-configuration-time" class="bare">https://blog.gradle.org/preview-avoiding-task-configuration-time</a></p></div></section><section id="i-o-at-configuration-time"><h2>I/O at configuration time</h2><div class="paragraph"><p>That build script seems expensive</p></div>
<div class="paragraph"><p><a href="https://scans.gradle.com/s/zs3qfbijbyka4/performance/configuration#stats.gradle" class="bare">https://scans.gradle.com/s/zs3qfbijbyka4/performance/configuration#stats.gradle</a></p></div></section><section id="i-o-at-configuration-time-2"><h2>I/O at configuration time</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">task projectStats {
    def statsFile = new File(buildDir, 'stats.txt')
    statsFile.parentFile.mkdirs()
    def javaFiles = sourceSets.main.java.size()
    def javaSize = sourceSets.main.java
	.collect{it.text.bytes}
	.flatten()
	.sum()
    statsFile.text = """
    |SourceFiles:  ${javaFiles}
    |Source size:  ${javaSize} bytes
    """.stripMargin()
}</code></pre>
<div class="paragraph"><p>Where is the problem?</p></div></section><section id="i-o-at-configuration-time-3"><h2>I/O at configuration time</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">task projectStats {
    def statsFile = new File(buildDir, 'stats.txt')
    input.files sourceSet.main.java
    outputs.file statsFile
    doLast {
        statsFile.parentFile.mkdirs()
        def javaFiles = sourceSets.main.java.size()
        def javaSize = sourceSets.main.java
        	.collect{it.text.bytes}
        	.flatten()
        	.sum()
        statsFile.text = """
        |SourceFiles:  ${javaFiles}
        |Source size:  ${javaSize} bytes
        """.stripMargin()
    }
}</code></pre>
<div class="paragraph"><p>Don&#8217;t forget <code>doLast{}</code></p></div></section><section id="i-o-at-configuration-time-4"><h2>I/O at configuration time</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">task projectStats(type: ProjectStats) {
    statsFile = new File(buildDir, 'stats.txt')
    sources = sourceSet.main.java
}

class ProjectStats extends DefaultTask {
    @InputFiles FileCollection sources
    @OutputFile File statsFile

    @TaskAction def stats() {
      statsFile.text = """
      |Files: ${sources.size()}
      |Total: ${sources.collect{it.text.bytes}.flatten().sum()} bytes
      """.stripMargin()
    }
}</code></pre></section><section id="inefficient-plugins"><h2>Inefficient Plugins</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">// version.gradle
def out = new ByteArrayOutputStream()
exec {
    commandLine 'git','rev-parse','HEAD'
    standardOutput = out
    workingDir = rootDir
}
version = new String(out.toByteArray())

// root 'build.gradle'
allprojects {
    apply from:'$rootDir/version.gradle'
}</code></pre></section><section id="re-use-expensive-logic"><h2>Re-use expensive logic</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">// root 'build.gradle'
apply from:"$rootDir/version.gradle"

subprojects {
    version = rootProject.version
}</code></pre></section><section id="variant-explosion"><h2>Variant explosion</h2><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">variantFilter { variant -&gt;
    def flavorName = variant.flavors[0].name
    def freeFlavor = flavorName == 'free'
    if(!freeFlavor &amp;&amp; variant.buildType.name == 'release') {
        variant.ignore = true
    }
}</code></pre></section><section id="configuration-time-2"><h2>Configuration Time</h2><div class="ulist"><ul><li><p>Avoid dependency resolution</p></li><li><p>Avoid I/O</p></li><li><p>Dont repeat yourself</p></li></ul></div></section></section>
<section><section id="gradle-build-cache"><h2>Gradle build cache</h2></section><section id="task-caching"><h2>Task caching</h2><div class="ulist"><ul><li><p>cache key based on inputs</p></li><li><p>outputs fetched from cache if available</p></li><li><p>no task action (re-)executed</p></li><li><p>opt-in (task declares cacheability)</p></li></ul></div></section><section id="usage-scenarios"><h2>Usage scenarios</h2><div class="ulist"><ul><li><p>Local branch switching</p></li><li><p>CI populated cache for (distributed) team</p></li><li><p>Faster CI builds with stateless agents</p></li></ul></div></section><section id="mechanics"><h2>Mechanics</h2><div class="ulist"><ul><li><p>stable inputs</p></li><li><p>repeatable outputs</p></li><li><p>classpath normalization</p></li><li><p>Path relocatability</p></li></ul></div></section><section id="enable-caching"><h2>Enable caching</h2><div class="paragraph"><p><code>org.gradle.caching = true</code></p></div>
<div class="title">build.gradle</div><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">// only for kotlin &lt; 1.3.30
subprojects {
    pluginManager.withPlugin("kotlin-kapt") {
        kapt.useBuildCache = true
    }
}</code></pre>
<div class="paragraph"><p><a href="https://youtrack.jetbrains.com/issue/KT-27675" class="bare">https://youtrack.jetbrains.com/issue/KT-27675</a></p></div>
<div class="ulist"><ul><li><p>uses local cache by default</p></li></ul></div></section><section id="cached-unit-tests"><h2>Cached unit tests</h2><div class="ulist"><ul><li><p>the default for java projects</p></li><li><p>coming in AGP 3.5</p></li><li><p>be aware of <code>includeAndroidResources = true</code></p></li></ul></div>
<div class="paragraph"><p><a href="https://issuetracker.google.com/issues/115873047#comment4" class="bare">https://issuetracker.google.com/issues/115873047#comment4</a></p></div></section><section id="android-best-practices"><h2>Android best practices</h2><div class="paragraph"><p><a href="https://guides.gradle.org/using-build-cache/#caching_android_projects" class="bare">https://guides.gradle.org/using-build-cache/#caching_android_projects</a></p></div></section><section id="remote-cache"><h2>Remote cache</h2><div class="imageblock" style=""><img src="./images/build-cache.png" alt="build cache" width="600px" height="500px" /></div></section><section><div class="title">settings.gradle</div><pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">def runsOnCI = System.getEnv("CI") != null

buildCache {
    local {
        enabled = !runsOnCI
    }
    remote(HttpBuildCache) {
        push = runsOnCI
        url = 'https://my.server.com:8080/cache/'
	// if cache access is secured
	credentials {
	    username = 'cache-user'
	    password = 'super-secret-pw'
        }
    }
}</code></pre>
<div class="paragraph"><p><a href="https://docs.gradle.org/current/userguide/build_cache.html#sec:build_cache_configure" class="bare">https://docs.gradle.org/current/userguide/build_cache.html#sec:build_cache_configure</a></p></div></section><section id="gradle-remote-cache-backend"><h2>Gradle Remote Cache Backend</h2><pre class="highlight listingblock"><code data-noescape="" class="bash language-bash">docker run -d \
	   -v /opt/build-cache-node:/data \
           -p 80:5071 \
	   gradle/build-cache-node:latest</code></pre>
<div class="paragraph"><p><a href="https://docs.gradle.com/build-cache-node/" class="bare">https://docs.gradle.com/build-cache-node/</a></p></div></section><section id="gradle-enterprise-cache"><h2>Gradle Enterprise cache $$$</h2><div class="paragraph"><p><a href="https://gradle.com/build-cache/" class="bare">https://gradle.com/build-cache/</a></p></div></section></section>
<section><section id="improvements-in-agp"><h2>Improvements in AGP?</h2></section><section id="improving-build-speed"><h2>Improving Build Speed</h2><div class="paragraph"><p><a href="https://medium.com/androiddevelopers/improving-build-speed-in-android-studio-3e1425274837" class="bare">https://medium.com/androiddevelopers/improving-build-speed-in-android-studio-3e1425274837</a></p></div></section><section id="configuration-avoidance-2"><h2>Configuration Avoidance</h2><div class="paragraph"><p>K-9: tasks created in 3.2.1 vs 3.3.2</p></div>
<div class="ulist"><ul><li><p>AGP3.2.1
<a href="https://scans.gradle.com/s/yb6nlteqjfg3e/performance/configuration?openScriptsAndPlugins=WzAsMV0#android-library" class="bare">https://scans.gradle.com/s/yb6nlteqjfg3e/performance/configuration?openScriptsAndPlugins=WzAsMV0#android-library</a></p></li><li><p>AGP3.3.2
<a href="https://scans.gradle.com/s/mvkrvxqjv76yu/performance/configuration?openScriptsAndPlugins=WzEsMF0#com.android.library" class="bare">https://scans.gradle.com/s/mvkrvxqjv76yu/performance/configuration?openScriptsAndPlugins=WzEsMF0#com.android.library</a></p></li></ul></div>
<div class="paragraph"><p><a href="https://docs.gradle.org/current/userguide/task_configuration_avoidance.html" class="bare">https://docs.gradle.org/current/userguide/task_configuration_avoidance.html</a></p></div></section><section id="cacheability"><h2>Cacheability</h2><div class="paragraph"><p>K-9: tests in <code>mail</code> subprojects</p></div>
<div class="ulist"><ul><li><p>AGP3.2.1
<a href="https://gradle.com/s/myfmftgb2oq46" class="bare">https://gradle.com/s/myfmftgb2oq46</a></p></li><li><p>AGP3.3.2
<a href="https://gradle.com/s/fnyeyuqwq4smc" class="bare">https://gradle.com/s/fnyeyuqwq4smc</a></p></li><li><p>AGP3.4.0-rc02
<a href="https://gradle.com/s/anej7zjlita4m" class="bare">https://gradle.com/s/anej7zjlita4m</a></p></li><li><p>AGP3.5.0-alpha10
<a href="https://gradle.com/s/4syrt4v2kevqw" class="bare">https://gradle.com/s/4syrt4v2kevqw</a></p></li></ul></div></section><section id="lint"><h2>Lint</h2><div class="paragraph"><p>K-9: <code>check -x test</code></p></div>
<div class="ulist"><ul><li><p>AGP 3.2.1 / no parallel
<a href="https://gradle.com/s/4plps3frlfvum" class="bare">https://gradle.com/s/4plps3frlfvum</a></p></li><li><p>AGP 3.2.1 / parallel
<a href="https://gradle.com/s/4drqo5ptwx2ku" class="bare">https://gradle.com/s/4drqo5ptwx2ku</a></p></li><li><p>AGP 3.3.2 / parallel
<a href="https://gradle.com/s/npoywvn63kg2k" class="bare">https://gradle.com/s/npoywvn63kg2k</a></p></li></ul></div></section><section id="cacheability-2"><h2>Cacheability</h2><div class="paragraph"><p><a href="https://docs.gradle.org/current/userguide/build_cache.html" class="bare">https://docs.gradle.org/current/userguide/build_cache.html</a></p></div>
<div class="ulist"><ul><li><p><a href="https://issuetracker.google.com/issues/121288180" class="bare">https://issuetracker.google.com/issues/121288180</a></p></li><li><p><a href="https://issuetracker.google.com/issues/121251997" class="bare">https://issuetracker.google.com/issues/121251997</a></p></li><li><p><a href="https://issuetracker.google.com/issues/115873047" class="bare">https://issuetracker.google.com/issues/115873047</a></p></li><li><p><a href="https://issuetracker.google.com/issues/115873051" class="bare">https://issuetracker.google.com/issues/115873051</a></p></li></ul></div></section><section id="annotation-processing-improvements"><h2>Annotation Processing Improvements</h2><div class="paragraph"><p><a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:incremental_annotation_processing" class="bare">https://docs.gradle.org/current/userguide/java_plugin.html#sec:incremental_annotation_processing</a></p></div>
<div class="ulist"><ul><li><p><a href="https://issuetracker.google.com/issues/115774858" class="bare">https://issuetracker.google.com/issues/115774858</a></p></li></ul></div></section><section id="memory-leak-fixes"><h2>Memory Leak Fixes</h2><div class="ulist"><ul><li><p><a href="https://issuetracker.google.com/issues/123068209" class="bare">https://issuetracker.google.com/issues/123068209</a></p></li><li><p><a href="https://issuetracker.google.com/issues/122301106" class="bare">https://issuetracker.google.com/issues/122301106</a></p></li></ul></div></section><section id="databinding"><h2>Databinding</h2><div class="ulist"><ul><li><p><a href="https://issuetracker.google.com/issues/110061530#comment28" class="bare">https://issuetracker.google.com/issues/110061530#comment28</a></p></li></ul></div></section></section>
<section><section id="conclusion"><h2>Conclusion</h2></section><section id="takeaways"><h2>Takeaways</h2><div class="ulist"><ul><li><p>know your build</p></li><li><p>monitor and measure</p></li><li><p>avoid unnecessary configuration</p></li><li><p>avoid repeated work</p></li></ul></div></section><section id="resources-2"><h2>Resources</h2><div class="paragraph"><p><a href="https://docs.gradle.org" class="bare">https://docs.gradle.org</a></p></div></section></section>
<section id="thank-you"><h2>Thank you!</h2></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: 'reveal.js/plugin/notes/notes.js', async: true },
      
      
      
      
  ],

  

});</script><!-- this currently shows up at the wrong location in the final index.html which means the style font is not properly applied-->

<div class="footer">
</div></body></html>